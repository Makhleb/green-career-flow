<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.void2.careermanagement.dao.ApplyDao2">
    <select id="getApplyListByCompanyId">
        <![CDATA[
        SELECT
        hstr.job_post_no,
        jp.title,
        hstr.pass_yn,
        re.resume_no,
        re.job_history,
        re.user_id,
        us.user_name,
        us.user_gender,
        TIMESTAMPDIFF(YEAR, us.user_birth, CURDATE())-(RIGHT(CURDATE(), 5) < RIGHT(us.user_birth, 5)) AS user_age
        FROM
        (SELECT job_post_no, resume_no, aplc_hstr_date, pass_yn
        FROM tbl_aplc_hstr
        WHERE job_post_no
        IN (SELECT job_post_no
        FROM tbl_job_post
        WHERE company_id = 'company03')) AS hstr
        LEFT JOIN tbl_job_post jp ON hstr.job_post_no = jp.job_post_no -- 기업정보
        LEFT JOIN tbl_resume re ON hstr.resume_no = re.resume_no -- 이력서 정보
        LEFT JOIN tbl_user us ON re.user_id = us.user_id -- 유저 정보
        WHERE jp.company_id = 'company03'
        ORDER BY hstr.aplc_hstr_date DESC
        LIMIT 3;
        ]]>
    </select>
    <select id="getSkillListByResumeNo">
        SELECT
        A.resume_no, A.skill_code AS code, B.name AS name
        FROM tbl_resume_skill A
        LEFT JOIN
        (SELECT CODE, NAME
        FROM tbl_gubn
        WHERE group_code = 'SKILL') B
        ON A.skill_code = B.code
        WHERE A.resume_no = #{resumeNo}
    </select>
</mapper>

