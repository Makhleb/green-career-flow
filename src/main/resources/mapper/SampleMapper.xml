<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.void2.careermanagement.dao.SampleDao">
    <select id="selectUser" resultType="com.void2.careermanagement.dto.UserDto">
        SELECT * FROM tbl_user;
    </select>
    <select id="selectJobPostWithDynamicJoin" resultType="com.void2.careermanagement.dto.JobPostDto">
        SELECT
        A.*,
        <!-- gubnList에서 각 항목의 NAME을 선택 -->
        <foreach collection="gubnList" item="gubn" index="index" separator=",">
            ${gubn}.NAME AS ${gubn}_NAME
        </foreach>
        FROM
        tbl_job_post A
        <!-- gubnList를 기반으로 LEFT JOIN 생성 -->
        <foreach collection="gubnList" item="gubn" index="index">
            LEFT JOIN (
            SELECT *
            FROM tbl_gubn
            WHERE group_code = #{gubn}
            ) ${gubn}
            ON A.${gubn}_CODE = ${gubn}.CODE
        </foreach>
        WHERE
        job_post_no = #{jobPostNo}
    </select>
</mapper>